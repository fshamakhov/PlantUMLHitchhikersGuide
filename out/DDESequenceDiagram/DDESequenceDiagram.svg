<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="532px" preserveAspectRatio="none" style="width:1139px;height:532px;" version="1.1" viewBox="0 0 1139 532" width="1139px" zoomAndPan="magnify"><defs><filter height="300%" id="fzlsh4n9pnhps" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FF0000" height="520.0547" style="stroke:#A80036;stroke-width:1.0;" width="495.5" x="106" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="131" x="288.25" y="18.0669">UnTrustedDomain</text><rect fill="#008000" height="520.0547" style="stroke:#A80036;stroke-width:1.0;" width="252.5" x="603.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="112" x="673.75" y="18.0669">TrustedDomain</text><rect fill="#FFFFFF" filter="url(#fzlsh4n9pnhps)" height="339.3281" style="stroke:#000000;stroke-width:2.0;" width="1115" x="10" y="104.4297"/><rect fill="#FFFFFF" filter="url(#fzlsh4n9pnhps)" height="98.3984" style="stroke:#000000;stroke-width:2.0;" width="323.5" x="597.5" y="128.5625"/><rect fill="#FFFFFF" filter="url(#fzlsh4n9pnhps)" height="195.7969" style="stroke:#000000;stroke-width:2.0;" width="1095" x="20" y="240.9609"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="180" x2="180" y1="87.4297" y2="460.7578"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="427.5" x2="427.5" y1="87.4297" y2="460.7578"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="558.5" x2="558.5" y1="87.4297" y2="460.7578"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="672.5" x2="672.5" y1="87.4297" y2="460.7578"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="806" x2="806" y1="87.4297" y2="460.7578"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="135" x="110" y="84.1279">UnTrustedKeyStore</text><path d="M162.5,35.1328 C162.5,25.1328 180.5,25.1328 180.5,25.1328 C180.5,25.1328 198.5,25.1328 198.5,35.1328 L198.5,61.1328 C198.5,71.1328 180.5,71.1328 180.5,71.1328 C180.5,71.1328 162.5,71.1328 162.5,61.1328 L162.5,35.1328 " fill="#FEFECE" filter="url(#fzlsh4n9pnhps)" style="stroke:#000000;stroke-width:1.5;"/><path d="M162.5,35.1328 C162.5,45.1328 180.5,45.1328 180.5,45.1328 C180.5,45.1328 198.5,45.1328 198.5,35.1328 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="135" x="110" y="472.7529">UnTrustedKeyStore</text><path d="M162.5,486.0547 C162.5,476.0547 180.5,476.0547 180.5,476.0547 C180.5,476.0547 198.5,476.0547 198.5,486.0547 L198.5,512.0547 C198.5,522.0547 180.5,522.0547 180.5,522.0547 C180.5,522.0547 162.5,522.0547 162.5,512.0547 L162.5,486.0547 " fill="#FEFECE" filter="url(#fzlsh4n9pnhps)" style="stroke:#000000;stroke-width:1.5;"/><path d="M162.5,486.0547 C162.5,496.0547 180.5,496.0547 180.5,496.0547 C180.5,496.0547 198.5,496.0547 198.5,486.0547 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="158" x="345.5" y="84.1279">UnTrustedKeyManager</text><ellipse cx="427.5" cy="55.1328" fill="#FEFECE" filter="url(#fzlsh4n9pnhps)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="423.5,43.1328,429.5,38.1328,427.5,43.1328,429.5,48.1328,423.5,43.1328" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="158" x="345.5" y="472.7529">UnTrustedKeyManager</text><ellipse cx="427.5" cy="492.0547" fill="#FEFECE" filter="url(#fzlsh4n9pnhps)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="423.5,480.0547,429.5,475.0547,427.5,480.0547,429.5,485.0547,423.5,480.0547" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="519.5" y="84.1279">KeyLoader</text><path d="M538,43.1328 L538,67.1328 M538,55.1328 L555,55.1328 " fill="none" filter="url(#fzlsh4n9pnhps)" style="stroke:#A80036;stroke-width:2.0;"/><ellipse cx="567" cy="55.1328" fill="#FEFECE" filter="url(#fzlsh4n9pnhps)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="519.5" y="472.7529">KeyLoader</text><path d="M538,480.0547 L538,504.0547 M538,492.0547 L555,492.0547 " fill="none" filter="url(#fzlsh4n9pnhps)" style="stroke:#A80036;stroke-width:2.0;"/><ellipse cx="567" cy="492.0547" fill="#FEFECE" filter="url(#fzlsh4n9pnhps)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="124" x="607.5" y="84.1279">PersistentStorage</text><path d="M654.5,35.1328 C654.5,25.1328 672.5,25.1328 672.5,25.1328 C672.5,25.1328 690.5,25.1328 690.5,35.1328 L690.5,61.1328 C690.5,71.1328 672.5,71.1328 672.5,71.1328 C672.5,71.1328 654.5,71.1328 654.5,61.1328 L654.5,35.1328 " fill="#FEFECE" filter="url(#fzlsh4n9pnhps)" style="stroke:#000000;stroke-width:1.5;"/><path d="M654.5,35.1328 C654.5,45.1328 672.5,45.1328 672.5,45.1328 C672.5,45.1328 690.5,45.1328 690.5,35.1328 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="124" x="607.5" y="472.7529">PersistentStorage</text><path d="M654.5,486.0547 C654.5,476.0547 672.5,476.0547 672.5,476.0547 C672.5,476.0547 690.5,476.0547 690.5,486.0547 L690.5,512.0547 C690.5,522.0547 672.5,522.0547 672.5,522.0547 C672.5,522.0547 654.5,522.0547 654.5,512.0547 L654.5,486.0547 " fill="#FEFECE" filter="url(#fzlsh4n9pnhps)" style="stroke:#000000;stroke-width:1.5;"/><path d="M654.5,486.0547 C654.5,496.0547 672.5,496.0547 672.5,496.0547 C672.5,496.0547 690.5,496.0547 690.5,486.0547 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="761" y="84.1279">KeyManager</text><ellipse cx="806.5" cy="55.1328" fill="#FEFECE" filter="url(#fzlsh4n9pnhps)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="802.5,43.1328,808.5,38.1328,806.5,43.1328,808.5,48.1328,802.5,43.1328" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="761" y="472.7529">KeyManager</text><ellipse cx="806.5" cy="492.0547" fill="#FEFECE" filter="url(#fzlsh4n9pnhps)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="802.5,480.0547,808.5,475.0547,806.5,480.0547,808.5,485.0547,802.5,480.0547" style="stroke:#A80036;stroke-width:1.0;"/><path d="M10,104.4297 L191,104.4297 L191,111.4297 L181,121.4297 L10,121.4297 L10,104.4297 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="339.3281" style="stroke:#000000;stroke-width:2.0;" width="1115" x="10" y="104.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="136" x="25" y="117.4966">In the Beginning...</text><path d="M597.5,128.5625 L716.5,128.5625 L716.5,135.5625 L706.5,145.5625 L597.5,145.5625 L597.5,128.5625 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="98.3984" style="stroke:#000000;stroke-width:2.0;" width="323.5" x="597.5" y="128.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="74" x="612.5" y="141.6294">RootKBPK</text><path d="M701,150.6953 L701,175.6953 L907,175.6953 L907,160.6953 L897,150.6953 L701,150.6953 " fill="#FBFB77" filter="url(#fzlsh4n9pnhps)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M897,150.6953 L897,160.6953 L907,160.6953 L897,150.6953 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="185" x="707" y="167.7622">A Unique random key is born</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="672.5" x2="714.5" y1="205.9609" y2="205.9609"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="714.5" x2="714.5" y1="205.9609" y2="218.9609"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="673.5" x2="714.5" y1="218.9609" y2="218.9609"/><polygon fill="#A80036" points="683.5,214.9609,673.5,218.9609,683.5,222.9609,679.5,218.9609" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="679.5" y="200.895">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="692.5" y="200.895">Root KBPK exists</text><path d="M20,240.9609 L277,240.9609 L277,247.9609 L267,257.9609 L20,257.9609 L20,240.9609 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="195.7969" style="stroke:#000000;stroke-width:2.0;" width="1095" x="20" y="240.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="212" x="35" y="254.0278">Storage in UnTrustedDomain</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="806.5" x2="848.5" y1="279.2266" y2="279.2266"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="848.5" x2="848.5" y1="279.2266" y2="292.2266"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="807.5" x2="848.5" y1="292.2266" y2="292.2266"/><polygon fill="#A80036" points="817.5,288.2266,807.5,292.2266,817.5,296.2266,813.5,292.2266" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="813.5" y="274.1606">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="132" x="826.5" y="274.1606">Create Class N KPBK</text><polygon fill="#A80036" points="794.5,317.3594,804.5,321.3594,794.5,325.3594,798.5,321.3594" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="672.5" x2="800.5" y1="321.3594" y2="321.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="679.5" y="316.2935">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="62" x="692.5" y="316.2935">RootKBPK</text><path d="M507,334.3594 L507,359.3594 L1101,359.3594 L1101,344.3594 L1091,334.3594 L507,334.3594 " fill="#FBFB77" filter="url(#fzlsh4n9pnhps)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1091,334.3594 L1091,344.3594 L1101,344.3594 L1091,334.3594 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="573" x="513" y="351.4263">Shorthand for create a KeyBlock with ClassKBPK N as key payload, and RootKBPK as KBPK</text><polygon fill="#A80036" points="191.5,385.625,181.5,389.625,191.5,393.625,187.5,389.625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="185.5" x2="426.5" y1="389.625" y2="389.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="197.5" y="384.5591">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="210.5" y="384.5591">KeyBlock[ClassKBPK N]RootKBPK</text><path d="M30,402.625 L30,427.625 L327,427.625 L327,412.625 L317,402.625 L30,402.625 " fill="#FBFB77" filter="url(#fzlsh4n9pnhps)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M317,402.625 L317,412.625 L327,412.625 L317,402.625 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="276" x="36" y="419.6919">Process is repeated for ClassKBPK 1,2,3...N</text><!--MD5=[b7120efa96c3dec8b47046e2cbe5dfa4]
@startuml DDESequenceDiagram


autonumber
box "UnTrustedDomain" #Red
	database UnTrustedKeyStore as UKS
	control UnTrustedKeyManager as UKM
    boundary KeyLoader as KL
end box

box "TrustedDomain" #Green
	database PersistentStorage as KS
    control KeyManager as KM

end box


group In the Beginning...
    
    group RootKBPK    
        note over KM: A Unique random key is born
        KS - -> KS: Root KBPK exists
    end
   
    group Storage in UnTrustedDomain 
        KM - -> KM: Create Class N KPBK
        KS - -> KM: RootKBPK 
        note over KM: Shorthand for create a KeyBlock with ClassKBPK N as key payload, and RootKBPK as KBPK
        UKM - -> UKS: KeyBlock[ClassKBPK N]RootKBPK        
        note over UKS: Process is repeated for ClassKBPK 1,2,3...N 
    end
end 

@enduml

PlantUML version 1.2020.22(Sun Dec 06 17:36:27 IRKT 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>